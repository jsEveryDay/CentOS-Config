# DO NOT EDIT. AUTOMATICALLY GENERATED BY WEBUZO.
# Replace domain.com and piwikdomain.com

                
server {    
    listen      *:80;
    server_name x.domain.com www.x.domain.com;
    # The Document Root
    root        /home/fintec/public_html;   
    error_log   /usr/local/apps/nginx/var/log/x.domain.com.err;
    access_log  /usr/local/apps/nginx/var/log/x.domain.com.log main;
    include     /usr/local/apps/nginx/etc/conf.d/common;
    
}

                
server {
    listen      *:443 ssl spdy;
    server_name x.domain.com www.x.domain.com;
    # The Document Root
    root        /home/fintec/public_html;
    error_log   /usr/local/apps/nginx/var/log/x.domain.com.err;
    access_log  /usr/local/apps/nginx/var/log/x.domain.com.log main;
    
    ssl                         on;
    ssl_certificate             /etc/ssl/cert/x.domain.com-nginx-cabundle.crt;
    ssl_certificate_key         /etc/ssl/private/x.domain.com.key;
    ssl_session_timeout         5m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers   on; 
    include     /usr/local/apps/nginx/etc/conf.d/common;
    
}
# --- JiveIM ---
upstream jivesite {
    ip_hash;
    server 127.0.0.1:9090 weight=30 max_fails=3 fail_timeout=30s;
}

server {
    listen 443 ssl spdy;
    server_name chat.domain.com;

    ssl                         on;
    ssl_certificate             /etc/ssl/cert/chat.domain.com-nginx-cabundle.crt;
    ssl_certificate_key         /etc/ssl/private/chat.domain.com.key;
	ssl_session_cache   		shared:SSL:10m;
    ssl_session_timeout         10m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers   on;
	ssl_stapling 				on;
    ssl_stapling_verify 		on;
    # Update headers
    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;

    # Remove E-Tag
    etag             off;

    client_max_body_size       10m;
    client_body_buffer_size    128k;

    proxy_redirect off;

    # Keep setting hide server information.
    proxy_pass_header Server;

    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

    proxy_connect_timeout      90;
    proxy_send_timeout         90;
    proxy_read_timeout         90;

    proxy_buffer_size          4k;
    proxy_buffers              4 32k;
    proxy_busy_buffers_size    64k;
    proxy_temp_file_write_size 64k;

    location / {
        proxy_pass http://jivesite;
        proxy_redirect off;
    }

    # Caching
    location ~* \.(?:ico|css|js|gif|jpe?g|png|woff)$ {
        proxy_pass http://jivesite;

        expires 30d;
        add_header Pragma public;
        add_header Cache-Control "public";
    }
}
                

upstream jiveim {
    server 127.0.0.1:9091 weight=5;
}

server {
    listen 443 ssl spdy;
    server_name im.domain.com;
    ssl                         on;
    ssl_certificate             /etc/ssl/cert/im.domain.com-nginx-cabundle.crt;
    ssl_certificate_key         /etc/ssl/private/im.domain.com.key;
	ssl_session_cache   		shared:SSL:10m;
    ssl_session_timeout         10m;
    ssl_protocols               TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!MD5;
	ssl_stapling 				off;
    ssl_stapling_verify 		off;
    ssl_prefer_server_ciphers   on; 
	

    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;

    location / {
        proxy_pass_header Server;

        # Enables WS support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_http_version 1.1;

        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-NginX-Proxy true;

        proxy_headers_hash_max_size 51200;
        proxy_headers_hash_bucket_size 6400;

        proxy_pass http://jiveim;
        proxy_redirect off;
    }
}

server {
	listen		*:443 ssl spdy;
	server_name	b2bdatanow.com;
	# The Document Root
	root		/home/fintec/www/b2bdatanow.com;
	error_log	/usr/local/apps/nginx/var/log/b2bdatanow.com.err;
	access_log	/usr/local/apps/nginx/var/log/b2bdatanow.com.log main;
	
	ssl							on;
	ssl_certificate				/etc/ssl/cert/b2bdatanow.com-nginx-cabundle.crt;
	ssl_certificate_key			/etc/ssl/private/b2bdatanow.com.key;
	ssl_session_timeout			5m;
	ssl_protocols				TLSv1 TLSv1.1 TLSv1.2;
	ssl_ciphers					HIGH:!aNULL:!MD5;
	ssl_prefer_server_ciphers   on;	
	include		/usr/local/apps/nginx/etc/conf.d/common;
	
}

